import"./constants-D2DsSXG6.js";import{i as N,k as T,j as P,d as Y,a as G}from"./constants-DNmD6dpJ.js";let i;sessionStorage.getItem("Data")?i=JSON.parse(sessionStorage.getItem("Data")):location.href="../signup/signup.html";JSON.parse(sessionStorage.getItem("Data")).comingFrom&&(sessionStorage.removeItem("User Type"),sessionStorage.removeItem("MedLinker Form"),sessionStorage.removeItem("Active Messages"),delete i.comingFrom,sessionStorage.setItem("Data",JSON.stringify(i)));let o,g=document.querySelector(".choices"),d=document.querySelector(".choices .return"),k=document.querySelector(".choices .exit"),W=document.querySelector(".company"),H=document.querySelector(".employee"),B=document.querySelector(".body-container"),u=document.querySelector(".employee-form"),p=document.querySelector(".employee-second-form"),L=document.querySelector(".company-form"),K=document.querySelector("form .back"),F=[...document.querySelectorAll("input:not([type=submit], [type=file])"),...document.querySelectorAll("select")],Q=[...document.querySelectorAll(".employee-second-form input:not([type=submit])"),...document.querySelectorAll(".employee-second-form select")],R=[...document.querySelectorAll(".employee-form input:not([type=submit])"),...document.querySelectorAll(".employee-form select")],X=[...document.querySelectorAll(".company-form input:not([type=submit])")],Z=document.querySelectorAll("input[name=fname]"),ee=document.querySelectorAll("input[name=lname]"),te=document.getElementById("employee-fname"),ae=document.getElementById("employee-lname"),le=document.getElementById("company-fname"),se=document.getElementById("company-lname"),re=document.querySelectorAll("input[name=email]"),oe=document.getElementById("employee-email"),ce=document.getElementById("company-email"),ne=document.querySelectorAll("input[name=username]"),ie=document.getElementById("company-name"),me=document.getElementById("employee-username"),de=document.getElementById("company-username"),ue=document.querySelectorAll("input[name=phone]"),pe=document.getElementById("company-phone"),ye=document.getElementById("employee-phone"),fe=document.getElementById("address"),n=document.getElementById("day"),c=document.getElementById("month"),E=document.getElementById("year"),ve=document.getElementById("level"),he=document.getElementById("military"),ge=document.querySelectorAll(".birth select"),M=document.getElementById("graduation"),Ee=document.querySelectorAll(".gender input[type=radio]"),q,Se=document.querySelectorAll("input[type=number]"),ke=document.getElementById("job-title"),f=document.getElementById("education"),v=document.getElementById("education-other"),Le=document.getElementById("years"),j=document.getElementById("months"),qe=document.getElementById("job-type"),_=document.getElementById("cv"),C=document.getElementById("photo"),be=document.querySelectorAll(".upload button"),Ie=document.querySelector(".max-cv-size"),xe=document.querySelector(".max-photo-size"),h=new Date,O=document.getElementById("employee-submit"),$=document.getElementById("company-submit");document.querySelector(".not-valid-message");let I=document.querySelector(".failed-message"),x=document.querySelector(".failed-cause-message"),Ae=document.querySelectorAll(".message:not(.success-message) i"),A=document.querySelector(".success-message"),w=document.querySelector(".loading"),m=document.querySelector(".overlay");function D(){g.style.marginLeft="-100%",L.style.display="none",u.style.display="block",p.style.display="block",setTimeout(()=>{d.style.display="flex",k.style.display="initial"},300),o="job-seeker",sessionStorage.setItem("User Type",o)}H.addEventListener("click",()=>{D()});function z(){g.style.marginLeft="-100%",u.style.display="none",p.style.display="none",L.style.display="block",setTimeout(()=>{d.style.display="flex",k.style.display="initial"},300),o="company",sessionStorage.setItem("User Type",o)}W.addEventListener("click",()=>{z()});k.addEventListener("click",()=>{g.style.marginLeft="-100%",setTimeout(()=>{d.style.display="flex"},300)});d.addEventListener("click",()=>{g.style.marginLeft="0",setTimeout(()=>{d.style.display="none"},200)});sessionStorage.getItem("User Type")&&(o=sessionStorage.getItem("User Type"));o&&(o==="job-seeker"?D():o==="company"&&z());let b=i.fullName.split(" "),Ne=b[0];Z.forEach(e=>{e.value=Ne});b.shift();let Te=b.join(" ");ee.forEach(e=>{e.value=Te});re.forEach(e=>{e.value=i.email});for(let e=1;e<=31;e++){let t=document.createElement("option");e<10?(t.append(document.createTextNode(`0${e}`)),t.setAttribute("value",`0${e}`)):(t.append(document.createTextNode(e)),t.setAttribute("value",e)),n.append(t)}for(let e=1;e<=12;e++){let t=document.createElement("option");e<10?(t.append(document.createTextNode(`0${e}`)),t.setAttribute("value",`0${e}`)):(t.append(document.createTextNode(e)),t.setAttribute("value",e)),c.append(t)}for(let e=h.getFullYear();e>=h.getFullYear()-60;e--){let t=document.createElement("option");t.append(document.createTextNode(e)),t.setAttribute("value",e),E.append(t)}for(let e=h.getFullYear()+10;e>=h.getFullYear()-50;e--){let t=document.createElement("option");t.append(document.createTextNode(e)),t.setAttribute("value",e),M.append(t)}function Be(e){let t=y(e).check;e.value.length>0?t?e.parentElement.querySelector(".not-valid").classList.remove("active"):e.parentElement.querySelector(".not-valid").classList.add("active"):e.parentElement.querySelector(".not-valid").classList.remove("active")}ne.forEach(e=>{e.addEventListener("input",()=>{Be(e)})});function Fe(e){let t=y(e).check;e.value.length>0?t?e.parentElement.querySelector(".not-valid").classList.remove("active"):e.parentElement.querySelector(".not-valid").classList.add("active"):e.parentElement.querySelector(".not-valid").classList.remove("active")}ue.forEach(e=>{e.addEventListener("input",()=>{Fe(e)})});function Me(e){let t=y(e).check;n.value>0&&c.value>0&&E.value>0&&(t?e.parentElement.querySelector(".not-valid").classList.remove("active"):e.parentElement.querySelector(".not-valid").classList.add("active"))}ge.forEach(e=>{e.addEventListener("input",()=>{Me(e)})});Ee.forEach(e=>{e.addEventListener("change",()=>{q=document.querySelector("input[type=radio]:checked")})});u.addEventListener("submit",e=>{e.preventDefault(),V(R)===!0&&(u.classList.add("finish"),p.classList.add("active")),B.scrollTo({top:0})});K.addEventListener("click",()=>{p.classList.remove("active"),u.classList.remove("finish"),B.scrollTo({top:0})});setInterval(()=>{Se.forEach(e=>{e.setAttribute("min","0")}),j.setAttribute("max","12")});f.addEventListener("input",()=>{f.value==="Other"?v.classList.add("active"):v.classList.remove("active")});be.forEach(e=>{e.addEventListener("click",()=>{e.parentElement.parentElement.querySelector("input[type=file]").click()})});Ie.textContent=N.show;xe.textContent=T.show;function U(e){e.files[0]?(e.parentElement.querySelector(".not-found").classList.remove("active"),y(e).check?(e.parentElement.querySelector(".not-valid").classList.remove("active"),e.parentElement.querySelector(".details").classList.add("active"),e.parentElement.querySelector(".details .file-name").textContent=e.files[0].name,e.parentElement.querySelector(".details .file-size").textContent=P(e.files[0].size)):(e.parentElement.querySelector(".details").classList.remove("active"),e.parentElement.querySelector(".not-valid").classList.add("active"))):(e.parentElement.querySelector(".details").classList.remove("active"),e.parentElement.querySelector(".not-valid").classList.remove("active"),e.parentElement.querySelector(".not-found").classList.add("active"))}_.addEventListener("input",e=>{U(e.target)});C.addEventListener("input",e=>{U(e.target)});function y(e){let t={input:e,name:e.name};if(e.type==="text")e.name==="email"?/.+@.+/i.test(e.value)?t.check=!0:t.check=!1:e.name==="username"?/^[a-z0-9]{8,}$/.test(e.value)?t.check=!0:t.check=!1:e.name==="phone"?/^(010|011|012|015)\d{8}$/.test(e.value)?t.check=!0:t.check=!1:e.name=="education-other"?e.classList.contains("active")&&(e.value.length>1?t.check=!0:t.check=!1):e.value.length>1?t.check=!0:t.check=!1;else if(e.tagName==="SELECT")e.parentElement.id==="birth"?n.value>0&&c.value>0&&E.value>0?c.value=="04"||c.value=="06"||c.value=="09"||c.value=="11"?n.value=="31"?t.check=!1:t.check=!0:c.value=="02"&&(n.value=="30"||n.value=="31")?t.check=!1:t.check=!0:t.check=!1:e.value==0?t.check=!1:e.value=="Other"?e.parentElement.querySelector("#education-other").value.length>0?t.check=!0:t.check=!1:t.check=!0;else if(e.type==="file"){let a=e.files[0];e.name==="cv"?a&&a.type==="application/pdf"&&a.size<=N.size?t.check=!0:t.check=!1:e.name==="photo"&&(a&&a.type.startsWith("image")&&a.size<=T.size?t.check=!0:t.check=!1)}else e.type==="radio"?document.querySelector(`input[name=${e.name}]:checked`)?t.check=!0:t.check=!1:e.type==="number"&&(e.value?t.check=!0:t.check=!1);return t}function V(e){let t=[];if(e.forEach(l=>{t.push(y(l))}),t.some(l=>l.check===!1)){let l=t.filter(r=>r.check===!1),s=[];for(let r of l)s.push(r.input);return s.forEach(r=>{r.parentElement.querySelector(".check-false")?r.parentElement.querySelector(".check-false").classList.add("active"):r.parentElement.parentElement.querySelector(".check-false").classList.add("active"),r.addEventListener("input",()=>{r.parentElement.querySelector(".check-false")?r.parentElement.querySelector(".check-false").classList.remove("active"):r.parentElement.parentElement.querySelector(".check-false").classList.remove("active")})}),s}else return!0}function je(){let e=new FormData,t={"Level 1":"1","Level 2":"2","Level 3":"3","Level 4":"4","Level 5":"5",Graduated:"graduated"},a={Male:"1",Female:"2"},l=f.value==="Other"?v.value:f.value;if(o==="job-seeker")e.append("user.username",me.value.trim()),e.append("user.password",i.password),e.append("user.first_name",te.value.trim()),e.append("user.last_name",ae.value.trim()),e.append("user.email",oe.value.trim()),e.append("user.user_type","job_seeker"),e.append("resume",_.files[0]),e.append("id_card",C.files[0]),e.append("education",l),e.append("birthdate",`${E.value}-${c.value}-${n.value}`),e.append("location_city",fe.value.trim()),e.append("job_title",ke.value.trim()),e.append("years_of_experience",Le.value),e.append("months_of_experience",j.value),e.append("gender",a[q.value]),e.append("contact_number",ye.value.trim()),e.append("current_level",t[ve.value]),e.append("military_status",he.value.toLowerCase()),e.append("job_type",qe.value.toLowerCase()),e.append("graduation_year",M.value);else if(o==="company")e.append("user.username",de.value.trim()),e.append("user.password",i.password),e.append("user.first_name",le.value.trim()),e.append("user.last_name",se.value.trim()),e.append("user.email",ce.value.trim()),e.append("user.user_type","company"),e.append("company_name",ie.value.trim()),e.append("phone_number",pe.value.trim());else return!1;return e}if(!sessionStorage.getItem("MedLinker Form")){let e={};sessionStorage.setItem("MedLinker Form",JSON.stringify(e))}F.forEach(e=>{e.addEventListener("input",()=>{let t=JSON.parse(sessionStorage.getItem("MedLinker Form"));e.type==="radio"?t[e.name]=e.value:t[e.id]=e.value,sessionStorage.setItem("MedLinker Form",JSON.stringify(t))})});function _e(){F.forEach(e=>{if(sessionStorage.getItem("MedLinker Form")){let t=JSON.parse(sessionStorage.getItem("MedLinker Form"));t[e.id]?e.tagName==="SELECT"?(document.querySelector(`select[name=${e.id}] option[value="${t[e.id]}"]`).setAttributeNode(document.createAttribute("selected")),e.id==="education"&&t[e.id]==="Other"&&v.classList.add("active")):e.value=t[e.id]:t[e.name]&&e.type==="radio"&&(document.querySelector(`input[value="${t[e.name]}"]`).setAttributeNode(document.createAttribute("checked")),q=document.querySelector("input[type=radio]:checked"))}})}_e();function Ce(e){let t=I.querySelector(".another-messages");if(I.classList.add("active"),m.classList.add("active"),Array.from(t.children).forEach(a=>{a.remove()}),e){let a=document.createElement("p"),l=document.createTextNode(`Error Code: ${e}`);a.append(l),a.classList.add("error-code"),t.append(a)}}function Oe(e,t){let a=x.querySelector(".another-messages");if(x.classList.add("active"),m.classList.add("active"),Array.from(a.children).forEach(l=>{l.remove()}),e){let l=document.createElement("p"),s=document.createTextNode(`Error Code: ${e}`);l.append(s),l.classList.add("error-code"),a.append(l)}for(let l of t){let s=document.createElement("p"),r=document.createTextNode(l.join(": "));s.append(r),s.classList.add(l[0]),a.append(s)}}function $e(){w.classList.add("active"),m.classList.add("active")}function we(){w.classList.remove("active"),m.classList.remove("active")}function De(){if(o==="job-seeker"){let e=A.querySelector("a");e.href="../home/home.html",e.textContent="Explore Jobs"}A.classList.add("active"),m.classList.add("active")}function S(e){clearInterval(e),o==="job-seeker"?O.removeAttribute("disabled"):o==="company"&&$.removeAttribute("disabled")}function ze(){sessionStorage.removeItem("User Type"),sessionStorage.removeItem("MedLinker Form"),sessionStorage.removeItem("Active Messages"),sessionStorage.removeItem("Data")}async function J(e,t){let a=setInterval(()=>{e.setAttributeNode(document.createAttribute("disabled"))});if(V(t)===!0){let l=je();$e();let s=await fetch(`${Y}/${G}/auth/register`,{method:"POST",body:l});if(s&&we(),s.status===201)De(),ze();else if(s.status===400){S(a);let r=await s.json();Oe(s.status,Object.entries(r.user))}else S(a),Ce(s.status)}else S(a)}p.addEventListener("submit",e=>{e.preventDefault(),e.submitter.tagName!=="BUTTON"&&J(O,Q)});L.addEventListener("submit",e=>{e.preventDefault(),J($,X)});Ae.forEach(e=>{e.addEventListener("click",()=>{e.parentElement.classList.remove("active"),m.classList.remove("active")})});

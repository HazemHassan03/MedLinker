import"./constants-D2DsSXG6.js";import"./header-BX0fN-_f.js";import{b as pe,d as L,a as A,g as X,s as Z,e as w,i as ce,j as Ke,l as Qe,m as ue}from"./constants-DNmD6dpJ.js";let t,Xe=document.querySelector(".job-seeker-body"),Ze=document.querySelector(".company-body"),et=document.querySelector(".go-back");et.addEventListener("click",()=>{location.href="../home/home.html"});async function me(){let c=await fetch(`${L}/${A}/users/jobseeker/me`,{headers:{Authorization:`Bearer ${await X()}`}});if(c.status==404)await de();else if(c.status==200){t=await c.json();let h=t.user.user_type;h==="job_seeker"?(Ze.remove(),await tt()):h==="company"&&(Xe.remove(),await de())}else c.status==401?await Z()===!0?await me():w("failed",void 0,"Something went wrong","We're sorry about that. Please try again."):w("failed",void 0,"Something went wrong","We're sorry about that. Please try again.");return c}await me();async function tt(){let c=document.querySelector(".user-card .cv .max-cv-size");c.textContent=ce.show,document.querySelector("section.user-card"),document.querySelector("section.job-applications");let h=document.querySelector("section.job-applications .applications"),ye=document.querySelector(".profile-message.inf.failed"),T=document.querySelector(".profile-message.apps.no-apps"),ee=document.querySelector(".profile-message.apps.failed"),fe=document.querySelector("select#birth-day"),ve=document.querySelector("select#birth-month"),he=document.querySelector("select#birth-year"),be=document.querySelector("select#graduation"),x=new Date;for(let e=1;e<=31;e++){let a=document.createElement("option");e<10?(a.append(document.createTextNode(`0${e}`)),a.setAttribute("value",`0${e}`)):(a.append(document.createTextNode(e)),a.setAttribute("value",e)),fe.append(a)}for(let e=1;e<=12;e++){let a=document.createElement("option");e<10?(a.append(document.createTextNode(`0${e}`)),a.setAttribute("value",`0${e}`)):(a.append(document.createTextNode(e)),a.setAttribute("value",e)),ve.append(a)}for(let e=x.getFullYear();e>=x.getFullYear()-60;e--){let a=document.createElement("option");a.append(document.createTextNode(e)),a.setAttribute("value",e),he.append(a)}for(let e=x.getFullYear()+10;e>x.getFullYear()-50;e--){let a=document.createElement("option");a.append(document.createTextNode(e)),be.append(a)}let te=document.querySelector(".user-card .education select"),b=document.querySelector(".user-card .education #education-other");te.addEventListener("input",()=>{te.value=="Other"?b.classList.add("active"):b.classList.remove("active")}),ye.remove();let l=document.querySelector(".user-card .user-inf"),ge=l.querySelector(".full-name"),V=l.querySelector(".full-name.edit-mode input#fname"),N=l.querySelector(".full-name.edit-mode input#lname"),Se=l.querySelector(".username .value"),qe=l.querySelector(".username.edit-mode .value"),_e=l.querySelector(".email .value"),we=l.querySelector(".email.edit-mode .value"),xe=l.querySelector(".phone .value"),P=l.querySelector(".phone.edit-mode input"),je=l.querySelector(".address .value"),F=l.querySelector(".address.edit-mode input"),Ee=l.querySelector(".gender .value"),z=l.querySelector(".gender.edit-mode select"),$e=l.querySelector(".job-title .value"),U=l.querySelector(".job-title.edit-mode input"),g=l.querySelector(".birth .value"),D=l.querySelector(".birth.edit-mode select#birth-day"),M=l.querySelector(".birth.edit-mode select#birth-month"),Y=l.querySelector(".birth.edit-mode select#birth-year"),Ce=l.querySelector(".level .value"),B=l.querySelector(".level.edit-mode select"),ke=l.querySelector(".graduation .value"),O=l.querySelector(".graduation.edit-mode select"),Le=l.querySelector(".education .value"),j=l.querySelector(".education.edit-mode select"),Ae=l.querySelector(".experience .value"),I=l.querySelector(".experience.edit-mode input#experience-years"),R=l.querySelector(".experience.edit-mode input#experience-months"),Te=l.querySelector(".job-type .value"),W=l.querySelector(".job-type.edit-mode select"),Ve=l.querySelector(".military .value"),G=l.querySelector(".military.edit-mode select"),Ne=document.querySelector(".user-card .cv .show"),Pe=document.querySelector(".user-card .cv .file-name .value"),Fe=document.querySelector(".user-card .cv .upload"),S=document.querySelector(".user-card .cv #cv");document.querySelector(".user-card .cv .file-inf");let H=document.querySelector(".user-card .cv .name .value"),ae=document.querySelector(".user-card .cv .size"),ze=document.querySelector(".user-card .cv .size .value"),Ue=`${t.user.first_name} ${t.user.last_name}`,le=t.gender==1?"Male":"Female",De=t.birthdate.split("-").reverse().join(" / "),Me=`${t.years_of_experience} year(s) and ${t.months_of_experience} month(s)`,re=`${t.job_type.split(" ")[0][0].toUpperCase()}${t.job_type.split(" ")[0].slice(1)} ${t.job_type.split(" ")[1][0].toUpperCase()}${t.job_type.split(" ")[1].slice(1)}`,oe=`${t.military_status[0].toUpperCase()}${t.military_status.slice(1)}`;ge.textContent=Ue,V.value=t.user.first_name,N.value=t.user.last_name,Se.textContent=t.user.username,qe.textContent=t.user.username,_e.textContent=t.user.email,we.textContent=t.user.email,xe.textContent=t.contact_number,P.value=t.contact_number,je.textContent=t.location_city,F.value=t.location_city,Ee.textContent=le,z.value=le,$e.textContent=t.job_title,U.value=t.job_title,g.textContent=De,g=t.birthdate.split("-"),D.value=g[2],M.value=g[1],Y.value=g[0];let m;+t.current_level<=5?m=`Level ${t.current_level}`:m=t.current_level,m==="graduated"&&(m="Graduated"),Ce.textContent=m,B.value=m,ke.textContent=t.graduation_year,O.value=t.graduation_year,Le.textContent=t.education,Array.from(j.querySelectorAll("option")).some(e=>e.value==t.education)?j.value=t.education:(b.classList.add("active"),b.value=t.education),Ae.textContent=Me,I.value=t.years_of_experience,R.value=t.months_of_experience,Te.textContent=re,W.value=re,Ve.textContent=oe,G.value=oe,Ne.href=t.resume;let Ye=new URL(t.resume),Be=Pe.textContent=H.textContent=Ye.pathname.split("/").at(-1);function Oe(){document.querySelectorAll(".user-card .view-mode").forEach(e=>e.classList.add("hide")),document.querySelectorAll(".user-card .edit-mode").forEach(e=>e.classList.remove("hide"))}function J(){document.querySelectorAll(".user-card .view-mode").forEach(e=>e.classList.remove("hide")),document.querySelectorAll(".user-card .edit-mode").forEach(e=>e.classList.add("hide"))}J(),document.querySelector(".user-card .edit-inf").addEventListener("click",Oe),document.querySelector(".user-card .close-editing").addEventListener("click",J),Fe.addEventListener("click",()=>{S.click()}),S.addEventListener("input",()=>{S.files[0]?(H.textContent=S.files[0].name,ae.classList.add("active"),ze.textContent=Ke(S.files[0].size)):(H.textContent=Be,ae.classList.remove("active"))});function Ie(e){let a={input:e,name:e.name};return e.type==="text"?e.value.length>0?a.result=!0:a.result=!1:e.type==="number"?e.value?e.id=="experience-months"?e.value<=11?a.result=!0:a.result=!1:a.result=!0:a.result=!1:e.tagName==="SELECT"?e.value==0?a.result=!1:e.value=="Other"?(a.input=e.parentElement.querySelector(".other"),e.parentElement.querySelector(".other").value.length>0?a.result=!0:a.result=!1):a.result=!0:e.type==="file"&&(e.files[0]?e.files[0].size<=ce.size&&e.files[0].type=="application/pdf"?a.result=!0:a.result=!1:a.result=!0),a}function Re(e){let a=[];return e.forEach(n=>{a.push(Ie(n))}),a.some(n=>n.result===!1)?a:!0}let We=[...document.querySelectorAll(".user-card input:not([type=submit], .other)"),...document.querySelectorAll(".user-card select")];function Ge(){let e=new FormData,a={Male:1,Female:2},o={"Level 1":"1","Level 2":"2","Level 3":"3","Level 4":"4","Level 5":"5",Graduated:"graduated"},n=j.value==="Other"?b.value:j.value;return V.value!==t.user.first_name&&e.append("user.first_name",V.value.trim()),N.value!==t.user.last_name&&e.append("user.last_name",N.value.trim()),P.value!==t.contact_number&&e.append("contact_number",P.value.trim()),F.value!==t.location_city&&e.append("location_city",F.value.trim()),a[z.value]!==t.gender&&e.append("gender",a[z.value]),U.value!==t.job_title&&e.append("job_title",U.value.trim()),`${Y.value}-${M.value}-${D.value}`!==t.birthdate&&e.append("birthdate",`${Y.value}-${M.value}-${D.value}`),o[B.value]!==t.current_level&&e.append("current_level",o[B.value]),+O.value!==t.graduation_year&&e.append("graduation_year",+O.value),n!==t.education&&e.append("education",n),+I.value!==t.years_of_experience&&e.append("years_of_experience",+I.value),+R.value!==t.months_of_experience&&e.append("months_of_experience",+R.value),W.value.toLowerCase()!==t.job_type&&e.append("job_type",W.value.toLowerCase()),G.value.toLowerCase()!==t.military_status&&e.append("military_status",G.value.toLowerCase()),cv.files[0]&&e.append("resume",cv.files[0]),e}function He(e){let a={};for(let[o,n]of e.entries())n instanceof File?a[o]=n.name:a[o]=n;return a}async function ie(){if(Re(We)===!0){let e=Ge();if(Object.values(He(e)).length>0){Qe();let a=await fetch(`${L}/${A}/users/jobseeker/me`,{method:"PATCH",headers:{Authorization:`Bearer ${await X()}`},body:e});pe(),a.status==200?w("success",void 0,"Your data has been successfully updated","Close this message to see your updated data.",void 0,!0):a.status==401?await Z()===!0?await ie():w("failed",void 0,"Something went wrong","We're sorry about that. Please try again."):w("failed",void 0,"Something went wrong","We're sorry about that. Please try again.")}else J()}}document.querySelector(".user-card input[type=submit]").addEventListener("click",ie);let u=new URLSearchParams(location.search),y=u.get("page"),f=document.querySelector("section.job-seeker-body .job-applications .options"),q=document.querySelector("section.job-seeker-body .job-applications .showing-details");async function K(e=`${L}/${A}/applications`){let a=await fetch(e,{headers:{Authorization:`Bearer ${await X()}`}});if(a.status==200){let o=await a.json(),n=o.results;if(o.count<=ue)f.style.display="none",q.style.display="none";else{let d=ue,s=d,v=s-d+1;y&&(s*=y,v=s-d+1),s>o.count&&(s=o.count);let E=q.querySelector(".showing"),r=q.querySelector(".count"),$=f.querySelector(".next"),C=f.querySelector(".back"),k=f.querySelector(".pages");E.textContent=`${v} - ${s}`,r.textContent=o.count,o.previous===null&&C.classList.add("disabled"),o.next===null&&$.classList.add("disabled");let p=y?+y:1,Q=Math.ceil(o.count/d);for(let i=p-2;i<=p+2;i++){if(i<1)continue;let _=document.createElement("button");if(_.append(document.createTextNode(i)),_.id=`page-${i}`,k.append(_),i===Q)break}document.getElementById(`page-${p}`).classList.add("active"),$.addEventListener("click",()=>{let i=new URLSearchParams(new URL(o.next).search).get("page");u.set("page",i),location.search=u.toString()}),C.addEventListener("click",()=>{let i=new URLSearchParams(new URL(o.previous).search).get("page");i===null&&(i=1),u.set("page",i),location.search=u.toString()}),k.querySelectorAll("button").forEach(i=>{i.addEventListener("click",()=>{u.set("page",i.textContent),location.search=u.toString()})})}if(n.length>0){T.remove(),ee.remove();for(let d of n){let s,v,E=/\sat\s/i,r=d.job;if((r.company_id==1||r.company_id==2)&&E.test(r.title)){let se=r.title.split(E);s=se[0],v=se[1]}let $=`${r.location_country}, ${r.location_city}`,C=`${r.position_type[0].toUpperCase()}${r.position_type.slice(1)}`,k=`${r.job_type.split(" ")[0][0].toUpperCase()}${r.job_type.split(" ")[0].slice(1)} ${r.job_type.split(" ")[1][0].toUpperCase()}${r.job_type.split(" ")[1].slice(1)}`,p=`${r.work_place[0].toUpperCase()}${r.work_place.slice(1)}`;p==="Onsite"&&(p="On-site");let Q=new Date(r.posted_date),ne=timeago.format(Q),i=new Date(d.date_applied),_=timeago.format(i),Je=`<div class="job-application">
                <a class="job-title" href="../job/job.html?id=${r.id}" target="_blank"
                  >${s||r.title}</a
                >
                <p class="post-date">${ne}</p>
                <p class="job-id">Job Id: ${r.id}</p>
                <p class="company-name">
                  <i class="fa-regular fa-building fa-fw"></i> ${v||r.company}</p>
                <p class="location">
                  <i class="fa-solid fa-location-dot fa-fw"></i> ${$}
                </p>
                <p class="vacancies">
                  <i class="fa-regular fa-user fa-fw"></i>
                  <span class="title">Number Of Vacancies: </span>
                  <span class="value">${r.number_of_vacancies}</span>
                </p>
                <div class="job-inf">
                  <span class="employment-type">${C}</span>
                  |
                  <span class="job-type">${k}</span>
                  |
                  <span class="workplace">${p}</span>
                </div>
                <p class="apply-date">Applied: ${_}</p>
              </div>`;h.insertAdjacentHTML("beforeend",Je)}}else ee.remove()}else a.status==401&&await Z()===!0?await K():(f.style.display="none",q.style.display="none",T.remove())}y?await K(`${L}/${A}/applications?page=${y}`):await K()}async function de(){document.write("Soon, Stay Tuned...")}pe();
